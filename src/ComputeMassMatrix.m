% ---------------------------------------------------------------------------- %
% _______/\\\\\\\\\\\\_________________________/\\\\\\\\\\\\__________________ %
% _______\/\\\////////\\\_____________________/\\\//////////__________________ %
% ________\/\\\______\//\\\___________________/\\\____________________________ %
% _________\/\\\_______\/\\\__________________\/\\\____/\\\\\\\_______________ %
% __________\/\\\_______\/\\\ iscontinuous_____\/\\\___\/////\\\ alerkin______ %
% ___________\/\\\_______\/\\\__________________\/\\\_______\/\\\_____________ %
% ____________\/\\\_______/\\\___________________\/\\\_______\/\\\____________ %
% _____________\/\\\\\\\\\\\\/____________________\//\\\\\\\\\\\\/____________ %
% ______________\////////////_______________________\////////////_____________ %
%                                                                              %
% ---------------------------------------------------------------------------- %
%                                                                              %
% Description:  Compute mass matrix of the element based on its basis          %
%               functions and quadrature                                       %
%                                                                              %
% Input:      phi ... ndof-by-nip matrix of basis functions evaluated at       %
%                     integration points corresponding to weights w            %
%               w ... nip-size vector of integration weights                   %
%                                                                              %
% Output:      Me ... Mass matrix of the element                               %
%                                                                              %
% ---------------------------------------------------------------------------- %

function Me = ComputeMassMatrix(phi, w)

  ndof = size(phi,1);
  nip  = size(phi,2);

  Me = zeros(ndof);

  for i = 1:ndof
    for j = 1:ndof
      for k = 1:nip
        Me(i,j) = Me(i,j) + w(k) * phi(i,k) * phi(j,k);
      end
    end
  end

end